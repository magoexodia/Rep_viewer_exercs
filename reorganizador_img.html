<!doctype html>
<html>
  <head>
    <title>Reorganiza√ß√£o de imagensüñºÔ∏è</title>
    <style>
      p,
      h1,
      h2,
      h3,
      h4 {
        background: #ff000092;
        text-shadow: 0 0 2px white;
      }

      body {
        font-size: 25px;
      }

      textarea {
        width: 99%;
        height: 98%;
        min-height: 50vh;
      }

      #buttonContainer {
        height: fit-content;
        width: 3vmax;
        display: block;
        position: fixed;
        top: 12px;
        right: 10px;
      }

      .butao {
        font-size: 3vmax;
        border: 2px solid black;
        border-radius: 1ch;
        background: gold;
        transition: background 1s ease;
        height: 5vmax;
        margin-bottom: 0.5ch;
        left: 1px;
      }

      input[type="checkbox"]:checked + label {
        filter: grayscale(0%);
      }

      input[type="checkbox"]:not(checked) + label {
        filter: grayscale(100%);
      }

      button:hover {
        background: purple;
        text-shadow:
          0 0 1px white,
          0 0 3px white,
          0 0 1ch white;
        transition: background 2s ease;
      }

      video:not(#previewVideo) {
        border: 2px solid black;
      }

      video:not(#previewVideo):hover {
        border-radius: 1ch;
        border: 2px solid purple;
      }

      #previewVideo {
        background: pink;
      }

      .ivList {
        height: 14ch;
        min-height: 100px;
        margin: 3px;
        padding: 3px;
      }

      #div1:not(.some) {
        display: flex;
        flex-direction: row;
      }

      #div1,
      #div2 {
        margin: 3px;
        padding: 3px;
        border: 1px solid black;
      }

      #div1 {
        overflow: auto;
        background: gray;
        min-height: 20vh;
        height: 80vh;
      }

      #previewContainer:not(.grande) {
        height: calc(20vh - 3ch);
        border: none;
      }

      #div2 {
        background: lightgreen;
        height: fit-content;
        z-index: -99;
        text-align: center;
      }

      .grande {
        position: fixed;
        bottom: 3px;
        top: 3px;
        left: 3px;
        right: 3px;
        width: 100%;
        height: calc(100vh - 0.5ch);
        overflow: auto;
        z-index: 9999;
        background: #550000a5;
        border-radius: 1ch;
      }

      @media screen and (orientation: landscape) {
        #div1 {
          height: calc(100svh - 8ch);
        }

        #previewContainer:not(.grande) {
          /*height: calc(100vh - 2ch);*/
          height: calc(8ch);
        }

        #div1,
        #div2 {
          width: calc(98% - 6vmax);
        }

        #previewContainer:not(.grande) {
          width: 8ch;
          display: block;
          position: fixed;
          bottom: 6px;
          right: 6px;
          background: #554f00a5;
        }

        #buttonContainer {
          right: calc(4ch + 15px);
        }
      }

      #previewVideo,
      #previewImage {
        height: 99%;
        width: 99%;
        object-fit: contain;
        margin: auto;
        background: none;
      }

      #imageContainer,
      .some {
        display: none;
      }

      .selected {
        background: white;
        border-radius: 1ch;
      }

      #label-linkInput {
        background-color: darkgray;
        text-align: center;
        /*writing-mode: vertical-lr;
        transform: rotate(180deg);
        text-overflow: none;*/
        display: block;
        position: absolute;
        top: 0;
        right: 50%;
      }

      #label-linkOutput {
        text-align: center;
      }
    </style>
  </head>

  <body>
    <div id="div1">
      <textarea
        id="linkInput"
        rows="4"
        cols="50"
        placeholder="Cole aqui seus links.
'link1.jpg',
'link2.png',
'link3.img',
'link5.png',
'link6.img',"
      ></textarea>
      <div id="imageContainer"></div>
      <div id="buttonContainer">
        <button id="okButton" class="butao">‚úîÔ∏è</button>
        <button id="resetButton" class="butao" style="display: none">üîô</button>
        <button id="deleteButton" class="butao" style="display: none">
          üóëÔ∏è
        </button>
        <button id="resultButton" class="butao" style="display: none">
          üü∞
        </button>
        <input type="checkbox" id="viewer" style="display: none" />
        <label id="label-viewer" class="butao" for="viewer">üëÄ</label>
        <button id="zoomin" class="butao" style="display: none">‚ûï</button>
        <button id="zoomout" class="butao" style="display: none">‚ûñ</button>
      </div>
    </div>
    <div
      id="previewContainer"
      style="display: none"
      onmouseover="this.classList.add('grande')"
    >
      <img id="previewImage" src="" />
      <video id="previewVideo" src="" style="display: none" controls></video>
    </div>
    <div id="div2">
      <div
        id="label-linkOutput"
        style="font-size: 2ch; height: 4ch; overflow-y: scroll"
        onmouseover="this.classList.toggle('grande)"
      >
        INSTRU√á√ïES: <br />Escolhe 1¬™üñºÔ∏è <wbr />depois 2¬™üñºÔ∏è<br />üñ±Duplo click
        aumenta = zoom<br />üñ±Mouse em cima da pre-visualiza√ß√£o = zoom<br />‚å®ESC
        = sai do zoom<br />üîô volta para entrada de lista <br />üóëÔ∏è apagar o item
        selecionado<br />üëÄ alterna pre-visualiza√ß√£o<br />üü∞ Mostra o
        resultado<br />
      </div>
      <textarea
        class="some"
        id="linkOutput"
        rows="4"
        cols="50"
        readonly
        onclick="this.select();"
      ></textarea>
      <button id="refazButton" class="butao some" style="font-size: 25px">
        üîô Retrabalhar sua lista
      </button>
    </div>

    <script>
      var selectedElement = null
      var allLines = []
      const link_asset =
        "https://assets.tumblr.com/images/media_violation/copyright_v1_1280.png"

      //Lista de elementos repetidos
      var lista = document.getElementById("linkInput")
      var bok = document.getElementById("okButton")
      var bdel = document.getElementById("deleteButton")
      var reseta = document.getElementById("resetButton")
      var resposta = document.getElementById("resultButton")
      var refaz = document.getElementById("refazButton")
      var prImage = document.getElementById("previewImage")
      var prVideo = document.getElementById("previewVideo")
      var prCont = document.getElementById("previewContainer")
      var zoomin = document.getElementById("zoomin")
      var zoomout = document.getElementById("zoomout")

      bok.addEventListener("click", function () {
        allLines = lista.value.trim().split("\n")
        const asset_img =
          '<img class="ivList" src="' +
          link_asset +
          '" onclick="selectElement(this);" onmouseover="previewImg(this.src); ">'
        const pv_img =
          '" onclick="selectElement(this);" onmouseover="previewImg(this.src);" ondblclick="prCont.classList.toggle(\'grande\')" class="ivList">'
        const pv_vd =
          '" onclick="selectElement(this);" onmouseover="previewVd(this.src);"  ondblclick="prCont.classList.toggle(\'grande\')" class="ivList"></video>'
        var imageContainer = document.getElementById("imageContainer")
        for (var i = 0; i < allLines.length; i++) {
          var src = allLines[i]
          if (src === "" || src === null) {
            // || src.includes('*')) {
            //imageContainer.innerHTML += '<br />';
          } else if (src.includes("/H")) {
            imageContainer.innerHTML +=
              asset_img + "<br />" + src + "<br />" + asset_img
          } else if (!src.includes("http")) {
            imageContainer.innerHTML += src
          } else if (src.includes("mp4") || src.includes("webm")) {
            imageContainer.innerHTML +=
              '<video src="' + src.replace(/['",]/g, "") + pv_vd
          } else {
            imageContainer.innerHTML +=
              '<img src="' + src.replace(/['",]/g, "") + pv_img
          }
          if (src.includes("[")) {
            imageContainer.innerHTML +=
              "<h1>" + src.replace(/['",]/g, "") + "</h1>"
          } else if (src.includes("];")) {
            imageContainer.innerHTML += "<h1>];</h1>"
          }
        }
        lista.style.display = "none"
        bok.style.display = "none"
        zoomin.style.display = "block"
        zoomout.style.display = "block"
        reseta.style.display = "block"
        resposta.style.display = "block"
        imageContainer.style.display = "block"
        //updateLinkOutput();
      })

      reseta.addEventListener("click", function () {
        location.reload()
      })

      resposta.addEventListener("click", function () {
        updateLinkOutput()
        document.getElementById("div1").classList.toggle("some")
        document.getElementById("linkOutput").classList.toggle("some")
        refaz.classList.toggle("some")
      })

      refaz.addEventListener("click", function () {
        //updateLinkOutput()
        document.getElementById("div1").classList.toggle("some")
        document.getElementById("linkOutput").classList.toggle("some")
      })

      bdel.addEventListener("click", function () {
        if (selectedElement !== null) {
          selectedElement.classList.remove("selected")
          selectedElement.remove()
          selectedElement = null
          //updateLinkOutput();
          bdel.style.display = "none"
        }
        prImage.src = ""
        prVideo.src = ""
        prCont.style.display = "none"
      })

      function previewImg(src) {
        prImage.src = src
        prImage.style.display = "block"
        prVideo.pause()
        prVideo.src = ""
        prVideo.style.display = "none"
        hideUnHide()
      }

      function previewVd(src) {
        prVideo.src = src
        prVideo.style.display = "block"
        prImage.style.display = "none"
        hideUnHide()
      }

      function hideUnHide() {
        prCont.style.display = document.getElementById("viewer").checked
          ? "block"
          : "none"
      }

      function selectElement(element) {
        if (selectedElement === null) {
          selectedElement = element
          element.classList.add("selected")
          bdel.style.display = "block"
        } else {
          if (selectedElement.tagName === element.tagName) {
            // Se os elementos s√£o do mesmo tipo, troque suas fontes
            var tempSrc = selectedElement.src
            selectedElement.src = element.src
            element.src = tempSrc
          } else {
            // Se os elementos s√£o de tipos diferentes, troque os pr√≥prios elementos
            var parentElement = selectedElement.parentElement
            var nextSibling = selectedElement.nextElementSibling
            element.parentElement.insertBefore(selectedElement, element)
            if (nextSibling) {
              parentElement.insertBefore(element, nextSibling)
            } else {
              parentElement.appendChild(element)
            }
          }
          selectedElement.classList.remove("selected")
          selectedElement = null
          //updateLinkOutput();
        }
      }

      function updateLinkOutput() {
        var elements = document
          .getElementById("imageContainer")
          .getElementsByTagName("*")
        var links = []
        for (var i = 0; i < elements.length; i++) {
          if (elements[i].src && elements[i].src !== link_asset) {
            links.push("'" + elements[i].src + "',")
          } else if (
            elements[i].src ||
            elements[i].tagName.toLowerCase().includes("br")
          ) {
          } else if (elements[i].tagName.toLowerCase() === "span") {
            links.push(elements[i].innerText)
          } else if (
            elements[i].textContent.includes("[") ||
            elements[i].textContent.includes("];")
          ) {
            links.push("\n\n" + elements[i].textContent)
          } else if (elements[i].tagName.toLowerCase().includes("h")) {
            links.push(
              "'<" +
                elements[i].tagName +
                ">" +
                elements[i].textContent +
                "</" +
                elements[i].tagName +
                ">',",
            )
          }
        }
        document.getElementById("linkOutput").value = links.join("\n")
      }

      document.addEventListener("keydown", function (event) {
        if (event.key === "Delete" && bdel.style.display === "block") {
          bdel.click()
        } else if (event.key === "F2" && reseta.style.display === "block") {
          reseta.click()
        } else if (event.key === "F3") {
          bok.click()
        } else if (event.key === "Escape") {
          prCont.classList.toggle("grande")
        } else if (event.key === "+") {
          zoomin.click()
        } else if (event.key === "-") {
          zoomout.click()
        }
      })

      function zoom(val) {
        const images = document.querySelectorAll(".ivList")
        images.forEach((image) => {
          // Get the current height of the image
          const currentHeight = window
            .getComputedStyle(image, null)
            .getPropertyValue("height")
          // Update the image height
          image.style.height = parseFloat(currentHeight) + val + "px"
        })
      }
      zoomin.addEventListener("click", function () {
        zoom(16)
      })

      zoomout.addEventListener("click", function () {
        zoom(-16)
      })
    </script>
  </body>
</html>
